# Pull down our base image (so the actual linux/windows image our app will run on)
FROM node:22-alpine

# Then we set where our files will live in the Docker container
WORKDIR /usr/src/app

# Copy SSL certificates for HTTPS support
COPY ../backend/certs/server.crt /usr/src/certs/server.crt
COPY ../backend/certs/server.key /usr/src/certs/server.key

# Then we copy our package.json (the file generated by NODE when we created our project)
# as it contains the names of all the required packages to make our project work.
COPY package*.json ./

# Install those packages, so that our frontend will work in the container
RUN npm i

# Once all the packages are installed, we then copy across the actual code for our frontend
COPY . .

# Expose HTTPS port (443) for production SSL
EXPOSE 443

# Run that thing (tell vite to allow connections from places other than localhost with HTTPS)
CMD ["npm", "run", "dev", "--", "--host", "0.0.0.0", "--port", "443", "--https"]
